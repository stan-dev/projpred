<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extend a family — extend_family • projpred</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extend a family — extend_family"><meta property="og:description" content="This function adds some internally required elements to an object of class
family (see, e.g., family()). It is called internally by
init_refmodel(), so you will rarely need to call it yourself."><meta property="og:image" content="https://mc-stan.org/projpred/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">projpred</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://mc-stan.org/rstan" class="external-link">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr" class="external-link">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm" class="external-link">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot" class="external-link">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan" class="external-link">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo" class="external-link">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools" class="external-link">rstantools</a>
    </li>
    <li>
      <a href="https://mc-stan.org/posterior" class="external-link">posterior</a>
    </li>
  </ul></li>
<li>
  <a href="https://mc-stan.org" class="external-link">Stan</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/mcmc_stan" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/projpred/" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extend a family</h1>
    <small class="dont-index">Source: <a href="https://github.com/stan-dev/projpred/blob/HEAD/R/extend_family.R" class="external-link"><code>R/extend_family.R</code></a></small>
    <div class="hidden name"><code>extend_family.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function adds some internally required elements to an object of class
<code>family</code> (see, e.g., <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family()</a></code>). It is called internally by
<code><a href="refmodel-init-get.html">init_refmodel()</a></code>, so you will rarely need to call it yourself.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extend_family</span><span class="op">(</span></span>
<span>  <span class="va">family</span>,</span>
<span>  latent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  latent_y_unqs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  latent_ilink <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  latent_ll_oscale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  latent_ppd_oscale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  augdat_y_unqs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  augdat_link <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  augdat_ilink <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  augdat_args_link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  augdat_args_ilink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>family</dt>
<dd><p>An object of class <code>family</code>.</p></dd>


<dt>latent</dt>
<dd><p>A single logical value indicating whether to use the latent
projection (<code>TRUE</code>) or not (<code>FALSE</code>). Note that setting <code>latent = TRUE</code>
causes all arguments starting with <code>augdat_</code> to be ignored.</p></dd>


<dt>latent_y_unqs</dt>
<dd><p>Only relevant for a latent projection where the original
response space has finite support (i.e., the original response values may
be regarded as categories), in which case this needs to be the character
vector of unique response values (which will be assigned to <code>family$cats</code>
internally) or may be left at <code>NULL</code> (so that <span class="pkg">projpred</span> will try to
infer it from <code>family$cats</code>). See also section "Latent projection" below.</p></dd>


<dt>latent_ilink</dt>
<dd><p>Only relevant for the latent projection, in which case
this needs to be the inverse-link function. If the original response family
was the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial()</a></code> or the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code> family, then <code>latent_ilink</code> can be
<code>NULL</code>, in which case an internal default will be used. Can also be <code>NULL</code>
in all other cases, but then an internal default based on <code>family$linkinv</code>
will be used which might not work for all families. See also section
"Latent projection" below.</p></dd>


<dt>latent_ll_oscale</dt>
<dd><p>Only relevant for the latent projection, in which
case this needs to be the function computing response-scale (not
latent-scale) log-likelihood values. If <code>!is.null(family$cats)</code> (after
taking <code>latent_y_unqs</code> into account) or if the original response family was
the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial()</a></code> or the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code> family, then <code>latent_ll_oscale</code> can be
<code>NULL</code>, in which case an internal default will be used. Can also be <code>NULL</code>
in all other cases, but then downstream functions will have limited
functionality (a message thrown by <code>extend_family()</code> will state what
exactly won't be available). See also section "Latent projection" below.</p></dd>


<dt>latent_ppd_oscale</dt>
<dd><p>Only relevant for the latent projection, in which
case this needs to be the function sampling response values given latent
predictors that have been transformed to response scale using
<code>latent_ilink</code>. If <code>!is.null(family$cats)</code> (after taking <code>latent_y_unqs</code>
into account) or if the original response family was the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial()</a></code> or
the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code> family, then <code>latent_ppd_oscale</code> can be <code>NULL</code>, in which
case an internal default will be used. Can also be <code>NULL</code> in all other
cases, but then downstream functions will have limited functionality (a
message thrown by <code>extend_family()</code> will state what exactly won't be
available). See also section "Latent projection" below. Note that although
this function has the abbreviation "PPD" in its name (which stands for
"posterior predictive distribution"), <span class="pkg">projpred</span> currently only uses it
in <code><a href="pred-projection.html">proj_predict()</a></code>, i.e., for sampling from what would better be termed
posterior-projection predictive distribution (PPPD).</p></dd>


<dt>augdat_y_unqs</dt>
<dd><p>Only relevant for augmented-data projection, in which
case this needs to be the character vector of unique response values (which
will be assigned to <code>family$cats</code> internally) or may be left at <code>NULL</code> if
<code>family$cats</code> is already non-<code>NULL</code>. See also section "Augmented-data
projection" below.</p></dd>


<dt>augdat_link</dt>
<dd><p>Only relevant for augmented-data projection, in which case
this needs to be the link function. Use <code>NULL</code> for the traditional
projection. See also section "Augmented-data projection" below.</p></dd>


<dt>augdat_ilink</dt>
<dd><p>Only relevant for augmented-data projection, in which
case this needs to be the inverse-link function. Use <code>NULL</code> for the
traditional projection. See also section "Augmented-data projection" below.</p></dd>


<dt>augdat_args_link</dt>
<dd><p>Only relevant for augmented-data projection, in which
case this may be a named <code>list</code> of arguments to pass to the function
supplied to <code>augdat_link</code>.</p></dd>


<dt>augdat_args_ilink</dt>
<dd><p>Only relevant for augmented-data projection, in
which case this may be a named <code>list</code> of arguments to pass to the function
supplied to <code>augdat_ilink</code>.</p></dd>


<dt>...</dt>
<dd><p>Ignored (exists only to swallow up further arguments which might
be passed to this function).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The <code>family</code> object extended in the way needed by <span class="pkg">projpred</span>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>In the following, \(N\), \(C_{\mathrm{cat}}\),
\(C_{\mathrm{lat}}\), \(S_{\mathrm{ref}}\), and
\(S_{\mathrm{prj}}\) from help topic <a href="refmodel-init-get.html">refmodel-init-get</a> are used.
Note that \(N\) does not necessarily denote the number of original
observations; it can also refer to new observations. Furthermore, let \(S\)
denote either \(S_{\mathrm{ref}}\) or \(S_{\mathrm{prj}}\),
whichever is appropriate in the context where it is used.</p>
    </div>
    <div id="augmented-data-projection">
    <h2>Augmented-data projection</h2>
    <p>As their first input, the functions supplied to arguments <code>augdat_link</code> and
<code>augdat_ilink</code> have to accept:</p><ul><li><p>For <code>augdat_link</code>: an \(S \times N \times C_{\mathrm{cat}}\) array containing the probabilities for the response categories. The
order of the response categories is the same as in <code>family$cats</code> (see
argument <code>augdat_y_unqs</code>).</p></li>
<li><p>For <code>augdat_ilink</code>: an \(S \times N \times C_{\mathrm{lat}}\) array containing the linear predictors.</p></li>
</ul><p>The return value of these functions needs to be:</p><ul><li><p>For <code>augdat_link</code>: an \(S \times N \times C_{\mathrm{lat}}\) array containing the linear predictors.</p></li>
<li><p>For <code>augdat_ilink</code>: an \(S \times N \times C_{\mathrm{cat}}\) array containing the probabilities for the response categories. The
order of the response categories has to be the same as in <code>family$cats</code> (see
argument <code>augdat_y_unqs</code>).</p></li>
</ul><p>For the augmented-data projection, the response vector resulting from
<code>extract_model_data</code> (see <code><a href="refmodel-init-get.html">init_refmodel()</a></code>) is coerced to a <code>factor</code> (using
<code><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor()</a></code>) at multiple places throughout this package. Inside of
<code><a href="refmodel-init-get.html">init_refmodel()</a></code>, the levels of this <code>factor</code> have to be identical to
<code>family$cats</code> (<em>after</em> applying <code>extend_family()</code> inside of
<code><a href="refmodel-init-get.html">init_refmodel()</a></code>). Everywhere else, these levels have to be a subset of
<code>&lt;refmodel&gt;$family$cats</code> (where <code>&lt;refmodel&gt;</code> is an object resulting from
<code><a href="refmodel-init-get.html">init_refmodel()</a></code>). See argument <code>augdat_y_unqs</code> for how to control
<code>family$cats</code>.</p>
<p>For ordinal <span class="pkg">brms</span> families, be aware that the submodels (onto which the
reference model is projected) currently have the following restrictions:</p><ul><li><p>The discrimination parameter <code>disc</code> is not supported (i.e., it is a
constant with value 1).</p></li>
<li><p>The thresholds are <code>"flexible"</code> (see <code><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html" class="external-link">brms::brmsfamily()</a></code>).</p></li>
<li><p>The thresholds do not vary across the levels of a <code>factor</code>-like variable
(see argument <code>gr</code> of <code><a href="https://rdrr.io/pkg/brms/man/addition-terms.html" class="external-link">brms::resp_thres()</a></code>).</p></li>
<li><p>The <code>"probit_approx"</code> link is replaced by <code>"probit"</code>.</p></li>
</ul><p>For the <code><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html" class="external-link">brms::categorical()</a></code> family, be aware that:</p><ul><li><p>For multilevel submodels, the group-level effects are allowed to be
correlated between different response categories.</p></li>
<li><p>For multilevel submodels, <span class="pkg">mclogit</span> versions &lt; 0.9.4 may throw the
error <code>'a' (&lt;number&gt; x 1) must be square</code>. Updating <span class="pkg">mclogit</span> to a
version &gt;= 0.9.4 should fix this.</p></li>
</ul></div>
    <div id="latent-projection">
    <h2>Latent projection</h2>
    <p>The function supplied to argument <code>latent_ilink</code> needs to have the prototype</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu">latent_ilink</span><span class="op">(</span><span class="va">lpreds</span>, <span class="va">cl_ref</span>, wdraws_ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cl_ref</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
<p>where:</p><ul><li><p><code>lpreds</code> accepts an \(S \times N\) matrix containing the linear
predictors.</p></li>
<li><p><code>cl_ref</code> accepts a numeric vector of length \(S_{\mathrm{ref}}\),
containing <span class="pkg">projpred</span>'s internal cluster indices for these draws.</p></li>
<li><p><code>wdraws_ref</code> accepts a numeric vector of length
\(S_{\mathrm{ref}}\), containing weights for these draws. These
weights should be treated as not being normalized (i.e., they don't
necessarily sum to <code>1</code>).</p></li>
</ul><p>The return value of <code>latent_ilink</code> needs to contain the linear predictors
transformed to the original response space, with the following structure:</p><ul><li><p>If <code>is.null(family$cats)</code> (after taking <code>latent_y_unqs</code> into account): an
\(S \times N\) matrix.</p></li>
<li><p>If <code>!is.null(family$cats)</code> (after taking <code>latent_y_unqs</code> into account): an
\(S \times N \times C_{\mathrm{cat}}\) array. In that case,
<code>latent_ilink</code> needs to return <em>probabilities</em> (for the response categories
given in <code>family$cats</code>, after taking <code>latent_y_unqs</code> into account).</p></li>
</ul><p>The function supplied to argument <code>latent_ll_oscale</code> needs to have the
prototype</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu">latent_ll_oscale</span><span class="op">(</span><span class="va">ilpreds</span>, <span class="va">y_oscale</span>, wobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y_oscale</span><span class="op">)</span><span class="op">)</span>, <span class="va">cl_ref</span>,</span>
<span>                 wdraws_ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cl_ref</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
<p>where:</p><ul><li><p><code>ilpreds</code> accepts the return value from <code>latent_ilink</code>.</p></li>
<li><p><code>y_oscale</code> accepts a vector of length \(N\) containing response values on
the original response scale.</p></li>
<li><p><code>wobs</code> accepts a numeric vector of length \(N\) containing observation
weights.</p></li>
<li><p><code>cl_ref</code> accepts the same input as argument <code>cl_ref</code> of <code>latent_ilink</code>.</p></li>
<li><p><code>wdraws_ref</code> accepts the same input as argument <code>wdraws_ref</code> of
<code>latent_ilink</code>.</p></li>
</ul><p>The return value of <code>latent_ll_oscale</code> needs to be an \(S \times N\)
matrix containing the response-scale (not latent-scale) log-likelihood values
for the \(N\) observations from its inputs.</p>
<p>The function supplied to argument <code>latent_ppd_oscale</code> needs to have the
prototype</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu">latent_ppd_oscale</span><span class="op">(</span><span class="va">ilpreds_resamp</span>, <span class="va">wobs</span>, <span class="va">cl_ref</span>,</span>
<span>                  wdraws_ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cl_ref</span><span class="op">)</span><span class="op">)</span>, <span class="va">idxs_prjdraws</span><span class="op">)</span></span></code></pre><p></p></div>
<p>where:</p><ul><li><p><code>ilpreds_resamp</code> accepts the return value from <code>latent_ilink</code>, but possibly
with resampled (clustered) draws (see argument <code>nresample_clusters</code> of
<code><a href="pred-projection.html">proj_predict()</a></code>).</p></li>
<li><p><code>wobs</code> accepts a numeric vector of length \(N\) containing observation
weights.</p></li>
<li><p><code>cl_ref</code> accepts the same input as argument <code>cl_ref</code> of <code>latent_ilink</code>.</p></li>
<li><p><code>wdraws_ref</code> accepts the same input as argument <code>wdraws_ref</code> of
<code>latent_ilink</code>.</p></li>
<li><p><code>idxs_prjdraws</code> accepts a numeric vector of length <code>dim(ilpreds_resamp)[1]</code>
containing the resampled indices of the projected draws (i.e., these indices
are values from the set \(\{1, ..., \texttt{dim(ilpreds)[1]}\}\) where <code>ilpreds</code> denotes the return value of
<code>latent_ilink</code>).</p></li>
</ul><p>The return value of <code>latent_ppd_oscale</code> needs to be a
\(\texttt{dim(ilpreds\_resamp)[1]} \times N\)
matrix containing the response-scale (not latent-scale) draws from the
posterior(-projection) predictive distributions for the \(N\) observations
from its inputs.</p>
<p>If the bodies of these three functions involve parameter draws from the
reference model which have not been projected (e.g., for <code>latent_ilink</code>, the
thresholds in an ordinal model), <code><a href="cl_agg.html">cl_agg()</a></code> is provided as a helper function
for aggregating these reference model draws in the same way as the draws have
been aggregated for the first argument of these functions (e.g., <code>lpreds</code> in
case of <code>latent_ilink</code>).</p>
<p>In fact, the weights passed to argument <code>wdraws_ref</code> are nonconstant only in
case of <code><a href="cv_varsel.html">cv_varsel()</a></code> with <code>cv_method = "LOO"</code> and <code>validate_search = TRUE</code>.
In that case, the weights passed to this argument are the PSIS-LOO CV weights
for one observation. Note that although argument <code>wdraws_ref</code> has the suffix
<code>_ref</code>, <code>wdraws_ref</code> does not necessarily obtain weights for the <em>initial</em>
reference model's posterior draws: In case of <code><a href="cv_varsel.html">cv_varsel()</a></code> with <code>cv_method = "kfold"</code>, these weights may refer to one of the \(K\) reference model
re-fits (but in that case, they are constant anyway).</p>
<p>If <code>family$cats</code> is not <code>NULL</code> (after taking <code>latent_y_unqs</code> into account),
then the response vector resulting from <code>extract_model_data</code> (see
<code><a href="refmodel-init-get.html">init_refmodel()</a></code>) is coerced to a <code>factor</code> (using <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor()</a></code>) at multiple
places throughout this package. Inside of <code><a href="refmodel-init-get.html">init_refmodel()</a></code>, the levels of
this <code>factor</code> have to be identical to <code>family$cats</code> (<em>after</em> applying
<code>extend_family()</code> inside of <code><a href="refmodel-init-get.html">init_refmodel()</a></code>). Everywhere else, these levels
have to be a subset of <code>&lt;refmodel&gt;$family$cats</code> (where <code>&lt;refmodel&gt;</code> is an
object resulting from <code><a href="refmodel-init-get.html">init_refmodel()</a></code>).</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Juho Piironen, Markus Paasiniemi, Alejandro Catalina, Frank Weber, Aki Vehtari.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

