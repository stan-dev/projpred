<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Projection onto submodel(s) — project • projpred</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Projection onto submodel(s) — project"><meta property="og:description" content="Project the posterior of the reference model onto the parameter space of a
single submodel consisting of a specific combination of predictor terms or
(after variable selection) onto the parameter space of a single or multiple
submodels of specific sizes."><meta property="og:image" content="https://mc-stan.org/projpred/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">projpred</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://mc-stan.org/rstan" class="external-link">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr" class="external-link">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm" class="external-link">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot" class="external-link">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan" class="external-link">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo" class="external-link">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools" class="external-link">rstantools</a>
    </li>
    <li>
      <a href="https://mc-stan.org/posterior" class="external-link">posterior</a>
    </li>
  </ul></li>
<li>
  <a href="https://mc-stan.org" class="external-link">Stan</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/mcmc_stan" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/projpred/" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Projection onto submodel(s)</h1>
    <small class="dont-index">Source: <a href="https://github.com/stan-dev/projpred/blob/HEAD/R/project.R" class="external-link"><code>R/project.R</code></a></small>
    <div class="hidden name"><code>project.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Project the posterior of the reference model onto the parameter space of a
single submodel consisting of a specific combination of predictor terms or
(after variable selection) onto the parameter space of a single or multiple
submodels of specific sizes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">project</span><span class="op">(</span>
  <span class="va">object</span>,
  nterms <span class="op">=</span> <span class="cn">NULL</span>,
  solution_terms <span class="op">=</span> <span class="cn">NULL</span>,
  refit_prj <span class="op">=</span> <span class="cn">TRUE</span>,
  ndraws <span class="op">=</span> <span class="fl">400</span>,
  nclusters <span class="op">=</span> <span class="cn">NULL</span>,
  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">integer.max</span>, <span class="fl">1</span><span class="op">)</span>,
  regul <span class="op">=</span> <span class="fl">1e-04</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An object which can be used as input to <code><a href="refmodel-init-get.html">get_refmodel()</a></code> (in
particular, objects of class <code>refmodel</code>).</p></dd>
<dt>nterms</dt>
<dd><p>Only relevant if <code>object</code> is of class <code>vsel</code> (returned by
<code><a href="varsel.html">varsel()</a></code> or <code><a href="cv_varsel.html">cv_varsel()</a></code>). Ignored if <code>!is.null(solution_terms)</code>.
Number of terms for the submodel (the corresponding combination of
predictor terms is taken from <code>object</code>). If a numeric vector, then the
projection is performed for each element of this vector. If <code>NULL</code> (and
<code>is.null(solution_terms)</code>), then the value suggested by the variable
selection is taken (see function <code><a href="suggest_size.html">suggest_size()</a></code>). Note that <code>nterms</code> does
not count the intercept, so use <code>nterms = 0</code> for the intercept-only model.</p></dd>
<dt>solution_terms</dt>
<dd><p>If not <code>NULL</code>, then this needs to be a character vector
of predictor terms for the submodel onto which the projection will be
performed. Argument <code>nterms</code> is ignored in that case. For an <code>object</code> which
is not of class <code>vsel</code>, <code>solution_terms</code> must not be <code>NULL</code>.</p></dd>
<dt>refit_prj</dt>
<dd><p>A single logical value indicating whether to fit the
submodels (again) (<code>TRUE</code>) or to retrieve the fitted submodels from
<code>object</code> (<code>FALSE</code>). For an <code>object</code> which is not of class <code>vsel</code>,
<code>refit_prj</code> must be <code>TRUE</code>.</p></dd>
<dt>ndraws</dt>
<dd><p>Only relevant if <code>refit_prj</code> is <code>TRUE</code>. Number of posterior
draws to be projected. Ignored if <code>nclusters</code> is not <code>NULL</code> or if the
reference model is of class <code>datafit</code> (in which case one cluster is used).
If both (<code>nclusters</code> and <code>ndraws</code>) are <code>NULL</code>, the number of posterior
draws from the reference model is used for <code>ndraws</code>. See also section
"Details" below.</p></dd>
<dt>nclusters</dt>
<dd><p>Only relevant if <code>refit_prj</code> is <code>TRUE</code>. Number of clusters
of posterior draws to be projected. Ignored if the reference model is of
class <code>datafit</code> (in which case one cluster is used). For the meaning of
<code>NULL</code>, see argument <code>ndraws</code>. See also section "Details" below.</p></dd>
<dt>seed</dt>
<dd><p>Pseudorandom number generation (PRNG) seed by which the same
results can be obtained again if needed. If <code>NULL</code>, no seed is set and
therefore, the results are not reproducible. See <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> for details.
Here, this seed is used for clustering the reference model's posterior
draws (if <code>!is.null(nclusters)</code>) and for drawing new group-level effects
when predicting from a multilevel submodel (however, not yet in case of a
GAMM).</p></dd>
<dt>regul</dt>
<dd><p>A number giving the amount of ridge regularization when
projecting onto (i.e., fitting) submodels which are GLMs. Usually there is
no need for regularization, but sometimes we need to add some
regularization to avoid numerical problems.</p></dd>
<dt>...</dt>
<dd><p>Arguments passed to <code><a href="refmodel-init-get.html">get_refmodel()</a></code> (if <code><a href="refmodel-init-get.html">get_refmodel()</a></code> is
actually used; see argument <code>object</code>) as well as to the divergence
minimizer (if <code>refit_prj</code> is <code>TRUE</code>).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If the projection is performed onto a single submodel (i.e.,
<code>length(nterms) == 1 || !is.null(solution_terms)</code>), an object of class
<code>projection</code> which is a <code>list</code> containing the following elements:</p><dl><dt><code>dis</code></dt>
<dd><p>Projected draws for the dispersion parameter.</p></dd>

<dt><code>kl</code></dt>
<dd><p>The KL divergence from the submodel to the reference
model.</p></dd>

<dt><code>weights</code></dt>
<dd><p>Weights for the projected draws.</p></dd>

<dt><code>solution_terms</code></dt>
<dd><p>A character vector of the submodel's
predictor terms, ordered in the way in which the terms were added to the
submodel.</p></dd>

<dt><code>submodl</code></dt>
<dd><p>A <code>list</code> containing the submodel fits (one fit per
projected draw).</p></dd>

<dt><code>p_type</code></dt>
<dd><p>A single logical value indicating whether the
reference model's posterior draws have been clustered for the projection
(<code>TRUE</code>) or not (<code>FALSE</code>).</p></dd>

<dt><code>refmodel</code></dt>
<dd><p>The reference model object.</p></dd>


</dl><p>If the projection is performed onto more than one submodel, the output from
above is returned for each submodel, giving a <code>list</code> with one element for
each submodel.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Arguments <code>ndraws</code> and <code>nclusters</code> are automatically truncated at
the number of posterior draws in the reference model (which is <code>1</code> for
<code>datafit</code>s). Using less draws or clusters in <code>ndraws</code> or <code>nclusters</code> than
posterior draws in the reference model may result in slightly inaccurate
projection performance. Increasing these arguments affects the computation
time linearly.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"rstanarm"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="co"># Data:</span></span>
<span class="r-in">  <span class="va">dat_gauss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">df_gaussian</span><span class="op">$</span><span class="va">y</span>, <span class="va">df_gaussian</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># The "stanreg" fit which will be used as the reference model (with small</span></span>
<span class="r-in">  <span class="co"># values for `chains` and `iter`, but only for technical reasons in this</span></span>
<span class="r-in">  <span class="co"># example; this is not recommended in general):</span></span>
<span class="r-in">  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rstanarm</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="va">y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">X5</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat_gauss</span>,</span>
<span class="r-in">    QR <span class="op">=</span> <span class="cn">TRUE</span>, chains <span class="op">=</span> <span class="fl">2</span>, iter <span class="op">=</span> <span class="fl">500</span>, refresh <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">9876</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Variable selection (here without cross-validation and with small values</span></span>
<span class="r-in">  <span class="co"># for `nterms_max`, `nclusters`, and `nclusters_pred`, but only for the</span></span>
<span class="r-in">  <span class="co"># sake of speed in this example; this is not recommended in general):</span></span>
<span class="r-in">  <span class="va">vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="varsel.html">varsel</a></span><span class="op">(</span><span class="va">fit</span>, nterms_max <span class="op">=</span> <span class="fl">3</span>, nclusters <span class="op">=</span> <span class="fl">5</span>, nclusters_pred <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">               seed <span class="op">=</span> <span class="fl">5555</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Projection onto the best submodel with 2 predictor terms (with a small</span></span>
<span class="r-in">  <span class="co"># value for `nclusters`, but only for the sake of speed in this example;</span></span>
<span class="r-in">  <span class="co"># this is not recommended in general):</span></span>
<span class="r-in">  <span class="va">prj_from_vs</span> <span class="op">&lt;-</span> <span class="fu">project</span><span class="op">(</span><span class="va">vs</span>, nterms <span class="op">=</span> <span class="fl">2</span>, nclusters <span class="op">=</span> <span class="fl">10</span>, seed <span class="op">=</span> <span class="fl">9182</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Projection onto an arbitrary combination of predictor terms (with a small</span></span>
<span class="r-in">  <span class="co"># value for `nclusters`, but only for the sake of speed in this example;</span></span>
<span class="r-in">  <span class="co"># this is not recommended in general):</span></span>
<span class="r-in">  <span class="va">prj</span> <span class="op">&lt;-</span> <span class="fu">project</span><span class="op">(</span><span class="va">fit</span>, solution_terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X3"</span>, <span class="st">"X5"</span><span class="op">)</span>, nclusters <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">                 seed <span class="op">=</span> <span class="fl">9182</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Juho Piironen, Markus Paasiniemi, Alejandro Catalina,
Frank Weber, Aki Vehtari.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

